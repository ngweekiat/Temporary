Sub Edge_FullHTML_Headless()
    Dim b As AutomateBrowser
    Dim html As String

    Set b = New_AutomateBrowser

    ' Launch Edge headless
    b.launch whichBrowser:=browserType.Edge, _
             url:="https://www.google.com/", _
             additionnalInlineCommands:="--headless=new --disable-gpu", _
             killWithoutAsking:=True

    ' Wait a bit for page to render
    Application.Wait (Now + TimeValue("0:00:05"))

    ' Grab full HTML
    html = CStr(b.jsEval("document.documentElement.outerHTML"))
    Debug.Print html

    b.Quit
End Sub
