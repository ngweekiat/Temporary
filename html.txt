Option Explicit

' Extract inner text for a given CSS selector
Function ExtractElementText(ByVal html As String, ByVal cssSelector As String) As String
    Dim htmlDoc As Object   ' use late binding (no need to add reference)
    Dim elem As Object
    
    Set htmlDoc = CreateObject("HTMLFILE")
    htmlDoc.body.innerHTML = html
    
    Set elem = htmlDoc.querySelector(cssSelector)
    
    If Not elem Is Nothing Then
        ExtractElementText = elem.innerText
    Else
        ExtractElementText = vbNullString
    End If
End Function
