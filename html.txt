Option Explicit

' Extract only the text node, excluding child tags like <a>
Function ExtractElementPlainText(ByVal html As String, ByVal cssSelector As String) As String
    Dim htmlDoc As Object
    Dim elem As Object
    
    Set htmlDoc = CreateObject("HTMLFILE")
    htmlDoc.body.innerHTML = html
    
    Set elem = htmlDoc.querySelector(cssSelector)
    
    If Not elem Is Nothing Then
        ' ChildNodes(0) should be the raw text node before the <a>
        If elem.childNodes.Length > 0 Then
            ExtractElementPlainText = Trim(elem.childNodes(0).nodeValue)
        Else
            ExtractElementPlainText = vbNullString
        End If
    Else
        ExtractElementPlainText = vbNullString
    End If
End Function
