Sub OpenNewTab()
    ' Get a reference to the existing browser window.
    ' This assumes a browser is already running.
    Dim browser As AutomateBrowser
    Set browser = New_AutomateBrowser

    ' Launch the browser and connect to an existing session.
    ' If no browser is open, it will launch a new one.
    ' You might need to adjust the launch parameters to match your specific setup.
    If Not browser.launch("https://www.google.com/") Then
        Debug.Print "Failed to launch or connect to browser."
        Exit Sub
    End If
    
    ' Get the target ID of the current active tab (the default one).
    Dim currentTarget As Dictionary
    Set currentTarget = browser.cdp.target.getTargetInfo
    Dim currentTargetId As String
    currentTargetId = currentTarget("targetInfo")("targetId")

    ' Create a new target (a new tab) and get its target ID.
    Dim newTabUrl As String
    newTabUrl = "https://www.bing.com/" ' The URL for the new tab.

    Dim newTarget As Dictionary
    Set newTarget = browser.cdp.target.createTarget(newTabUrl)
    Dim newTargetId As String
    newTargetId = newTarget("targetId")

    ' You can now switch to and interact with the new tab using its targetId.
    ' For example, you can switch the active session to the new target.
    browser.cdp.target.attachToTarget newTargetId
    
    ' To switch back to the original tab, you would re-attach to the original target ID.
    ' browser.cdp.target.attachToTarget currentTargetId

    ' Wait for a moment to see the new tab.
    ' This is for demonstration purposes.
    Application.Wait Now + TimeValue("00:00:05")

    ' Close the new tab.
    browser.cdp.target.closeTarget newTargetId

    ' Quit the browser.
    browser.Quit
End Sub