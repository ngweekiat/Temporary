Option Explicit

#If VBA7 Then
    Private Declare PtrSafe Function FindWindow Lib "user32" Alias "FindWindowA" _
        (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr

    Private Declare PtrSafe Function SetWindowPos Lib "user32" _
        (ByVal hwnd As LongPtr, ByVal hWndInsertAfter As LongPtr, _
        ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, _
        ByVal wFlags As Long) As Long

    Private Declare PtrSafe Function GetForegroundWindow Lib "user32" () As LongPtr
#Else
    Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" _
        (ByVal lpClassName As String, ByVal lpWindowName As String) As Long

    Private Declare Function SetWindowPos Lib "user32" _
        (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, _
        ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, _
        ByVal wFlags As Long) As Long

    Private Declare Function GetForegroundWindow Lib "user32" () As Long
#End If

Private Const SWP_NOSIZE As Long = &H1
Private Const SWP_NOMOVE As Long = &H2
Private Const SWP_NOACTIVATE As Long = &H10
Private Const HWND_TOPMOST As Long = -1

Private Sub UserForm_Initialize()
    ' Populate dropdown with options
    With cmbOptions
        .AddItem "Option 1"
        .AddItem "Option 2"
        .AddItem "Option 3"
    End With
End Sub

Private Sub UserForm_Activate()
    ' Keep form always on top
    Dim hWndForm As LongPtr
    hWndForm = FindWindow(vbNullString, Me.Caption)
    SetWindowPos hWndForm, HWND_TOPMOST, 0, 0, 0, 0, _
                 SWP_NOMOVE Or SWP_NOSIZE Or SWP_NOACTIVATE
End Sub

Private Sub cmbOptions_Click()
    ' Copy selected item to clipboard
    Dim DataObj As Object
    Set DataObj = CreateObject("MSForms.DataObject")
    DataObj.SetText cmbOptions.Value
    DataObj.PutInClipboard
End Sub


Sub ShowClipboardTool()
    frmClipboardTool.Show vbModeless
End Sub
