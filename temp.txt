Option Explicit

#If VBA7 Then
    Private Declare PtrSafe Function SetWindowPos Lib "user32" _
        (ByVal hWnd As LongPtr, ByVal hWndInsertAfter As LongPtr, _
         ByVal X As Long, ByVal Y As Long, ByVal cx As Long, ByVal cy As Long, _
         ByVal wFlags As Long) As LongPtr
    Private Declare PtrSafe Function FindWindow Lib "user32" Alias "FindWindowA" _
        (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr
#Else
    Private Declare Function SetWindowPos Lib "user32" _
        (ByVal hWnd As Long, ByVal hWndInsertAfter As Long, _
         ByVal X As Long, ByVal Y As Long, ByVal cx As Long, ByVal cy As Long, _
         ByVal wFlags As Long) As Long
    Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" _
        (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
#End If

Const HWND_TOPMOST = -1
Const SWP_NOSIZE = &H1
Const SWP_NOMOVE = &H2

Sub ShowClipboardTool()
    frmClipboardTool.Show vbModeless
    MakeFormTopMost frmClipboardTool.Caption
End Sub

Private Sub MakeFormTopMost(FormCaption As String)
    Dim hWnd As LongPtr
    hWnd = FindWindow(vbNullString, FormCaption)
    If hWnd <> 0 Then
        SetWindowPos hWnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE Or SWP_NOSIZE
    End If
End Sub




Private Sub UserForm_Initialize()
    ' Populate dropdown options
    With cmbOptions
        .AddItem "Option 1"
        .AddItem "Option 2"
        .AddItem "Option 3"
        .AddItem "My Custom Text"
    End With
End Sub

Private Sub cmbOptions_Click()
    ' Copy the selected text to clipboard when clicked
    Dim DataObj As Object
    Set DataObj = CreateObject("MSForms.DataObject")
    DataObj.SetText cmbOptions.Value
    DataObj.PutInClipboard
End Sub
