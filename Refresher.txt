Option Explicit

Dim br As AutomateBrowser
Dim targetURL As String

Sub KeepRefreshing()
    Dim start As Double
    
    ' Launch browser once
    If br Is Nothing Then
        Set br = New_AutomateBrowser
        targetURL = "https://your-target-page.com"
        
        br.launch whichBrowser:=browserType.Edge, _
                  url:=targetURL, _
                  killWithoutAsking:=True
                  
        br.cdp.Page.enable
        br.cdp.Runtime.enable
    End If
    
    Do
        ' Force hard reload by navigating to same URL with timestamp
        br.cdp.Page.navigate targetURL & "?ts=" & Format(Timer, "0.000")
        
        ' Wait for load event
        WaitForLoad 8
        
        Debug.Print "Page reloaded at " & Now
        
        ' Wait 5 seconds
        start = Timer
        Do While Timer - start < 5
            DoEvents
        Loop
    Loop
End Sub


Private Sub WaitForLoad(timeoutSeconds As Long)
    Dim t As Date: t = Now
    Dim msg As Dictionary
    
    Do While DateDiff("s", t, Now) < timeoutSeconds
        br.cdp.peakMessage
        Set msg = br.cdp.popMessageFromQueue
        
        If Not msg Is Nothing Then
            If msg.Exists("method") Then
                If msg("method") = "Page.loadEventFired" Then Exit Do
            End If
        End If
        
        DoEvents
    Loop
End Sub
